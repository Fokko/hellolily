!function(e){"use strict";e.module("app.base",["ui.bootstrap"])}(angular),function(e){"use strict";e.module("app.filters",[])}(angular),function(e){"use strict";e.module("app.directives",[])}(angular),function(e){"use strict";e.module("app.services",[])}(angular),function(e){"use strict";function t(e){var t={layout:{pageSidebarClosed:!1}};return e.settings=t,t}function n(e,t,n,i,r){e.setOptions({templateUrl:"breadcrumbs.html",includeAbstract:!0}),t.allowGlobals(),n.defaults.xsrfCookieName="csrftoken",n.defaults.xsrfHeaderName="X-CSRFToken",i.defaults.stripTrailingSlashes=!1,r.otherwise("/")}function i(e,t){e.$state=t,e.currentUser=currentUser}e.module("lilyApp",["ui.router","ui.bootstrap","ngResource","ngSanitize","ncy-angular-breadcrumb","app.accounts","app.base","app.cases","app.dashboard","app.email","app.preferences","app.preferences.email","app.preferences.user","app.templates","ContactsControllers","DealControllers","UtilsControllers","app.directives","app.accounts.directives","app.cases.directives","app.contacts.directives","app.deals.directives","UtilsDirectives","angulartics","angulartics.google.analytics","app.services","app.filters"]),e.module("lilyApp").factory("settings",t),t.$inject=["$rootScope"],e.module("lilyApp").config(n),n.$inject=["$breadcrumbProvider","$controllerProvider","$httpProvider","$resourceProvider","$urlRouterProvider"],e.module("lilyApp").run(i),i.$inject=["$rootScope","settings","$state"]}(angular),function(e){"use strict";$(function(){$("body").on("blur",'input[name^="phone"]',function(){var e=$(this),t=e.val();if(t.match(/[a-z]|[A-Z]/))return!1;if(t.match(/^\+316|^06/)){var n=e.attr("id").replace("raw_input","type");$("#"+n).select2("val","mobile")}return t=t.replace("(0)","").replace(/\s|\(|\-|\)|\.|x|:|\*/g,"").replace(/^00/,"+"),0==t.length?!1:(t.startsWith("+")||(t.startsWith("0")&&(t=t.substring(1)),t="+31"+t),t.startsWith("+310")&&(t="+31"+t.substring(4)),void e.val(t))}),$("body").on("change",'select[id*="is_primary"]',function(e){"True"==$(e.currentTarget).val()&&($('select[id*="is_primary"]').each(function(e){$(this).is("select")&&"True"==$(this).val()&&$(this).val("False")}),$(e.currentTarget).val("True"),HLSelect2.init())})})}(angular),function(e){"use strict";!function(e,t,n,i,r,a,o){e.GoogleAnalyticsObject=r,e[r]=e[r]||function(){(e[r].q=e[r].q||[]).push(arguments)},e[r].l=1*new Date,a=t.createElement(n),o=t.getElementsByTagName(n)[0],a.async=1,a.src=i,o.parentNode.insertBefore(a,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-60721851-1","auto")}(angular),function(e){"use strict";!function(e,t,n,i){t.HLDataProvider={config:{buttonDataProvider:":button.dataprovider",loadingText:"Beaming up the information now, almost within range!",loadingHeader:"I'm on my way!",provideUrl:"/provide/account/",dataProviderClass:".dataprovider",errorHeader:"Oops!",errorText:"There was an error trying to fetch your data, please don't be mad.",successHeader:"Yeah!",successText:"We did it! Your new data should be right there waiting for you.",hiddenSuccessHeader:"Psst!",hiddenSuccessText:"Did you know I did more work in the background? ;)",overwriteConfirmHeader:"Do you wish to overwrite the following fields?\n",fields:["name","description","legalentity","taxnumber","bankaccountnumber","cocnumber","iban","bic"],formsets:["email_addresses","phone_numbers","addresses"]},init:function(t){var n=this;e.isPlainObject(t)&&e.extend(n.config,t),n.initListeners()},initListeners:function(){var t=this,n=t.config;e("body").on("click",n.buttonDataProvider,function(e){t.findDataProviderInfo.call(t,this,e)}).on("keydown","div"+n.dataProviderClass+" > input",function(e){13===e.which&&(t.findDataProviderInfo.call(t,n.buttonDataProvider,e),e.preventDefault())})},findDataProviderInfo:function(t,n){var i=this,r=i.config,a=e(t),o=a.closest("form"),s=e("div"+r.dataProviderClass+" > input"),c=i.sanitizeDomain(s.val());a.button("loading"),toastr.info(r.loadingText,r.loadingHeader);var l=r.provideUrl+c;e.getJSON(l).done(function(e){e.error?toastr.error(e.error.message,r.errorHeader):(i.fillForm(o,e,r.fields,r.formsets),toastr.success(r.successText,r.successHeader))}).fail(function(){toastr.error(r.errorText,r.errorHeader)}).always(function(){a.button("reset")}),n.preventDefault()},sanitizeDomain:function(t){var n=e.trim(t.replace("http://",""));return n=e.trim(n.replace("https://","")),"/"!==n.slice(-1)&&(n+="/"),n},fillForm:function(e,t,n,i){var r=this,a=r.config,o=r.loopTroughFields(n,e,t),s=o[0],c=o[1];s.length&&confirm(a.overwriteConfirmHeader+c.join("\n"))&&s.forEach(function(n){var i=e.find('[name="'+n+'"]');r.fillField(i,t[n])}),r.loopTroughFormSets(i,e,t)},loopTroughFields:function(e,t,n){var r=this,a=r.config,o=[],s=[],c=!1;return e.forEach(function(e){var a=t.find('[name="'+e+'"]');if(("hidden"==a.attr("type")||a.parent().hasClass("hide"))&&(a.val(""),n[e]&&(c=!0)),n[e]&&a.val()!==i)if(a.val().length&&a.val()!==a.attr("placeholder")){var l=a.parents(".form-group").find("label").text();o.push(e),s.push("- "+l)}else r.fillField(a,n[e])}),c&&toastr.success(a.hiddenSuccessText,a.hiddenSuccessHeader),[o,s]},loopTroughFormSets:function(t,n,i){for(var r=0;r<t.length;r++){var a=t[r];if(i[a]&&i[a].length)for(var o,s=n.find("#"+a),c=s.find("[data-formset-add]"),l=i[a],u=0;u<l.length;u++){var d,f=l[u],p=!1;if("object"==typeof f){var h,m=!1;for(h in f)o=s.find(':input[name$="'+h+'"]'),o.length&&(m=!0,o=o.filter(function(){var t=e(this).val(),n=f[h];return""===t&&null===n||t==n}),o.length||(p=!0));if(p||!m){c.click(),d=s.find("[data-formset-body] [data-formset-form]:last");for(h in f)d.find(':input[name$="'+h+'"]').val(f[h])}}else"string"==typeof f&&(o=s.find(":input").filter(function(){return e(this).val()==f}),o.length||(c.click(),d=s.find("[data-formset-body] [data-formset-form]:last"),d.find(":input:first").val(f)))}}},fillField:function(e,t){if("string"==typeof t)e.val(t);else if("string"==typeof t[0]){var n=t.concat(e.val().split(",")).filter(function(e,t,n){return n.indexOf(e)===t&&""!==e});e.val(n.join())}else e.val(JSON.stringify(t));e.change(),e.parent().hasClass("original-form-widget")&&e.parent().hasClass("hide")&&e.parents(".show-and-hide-input").find('a[data-action="show"]').trigger("click")}}}(jQuery,window,document)}(angular),function(e){"use strict";!function(e,t,n,i){t.HLFormsets={config:{formsetClass:".formset"},init:function(t){var n=this;e.isPlainObject(t)&&e.extend(n.config,t),e(n.config.formsetClass).formset(),n.initListeners()},initListeners:function(){var t=e("body");t.on("formAdded","[data-formset-form]",function(){var t=e(this).parents(".formset"),n=e(t).find(".add-link"),i="true"==(e(t).attr("data-formset-indent")||"true");i&&e(n).find(".form-control-static").addClass("col-md-offset-2").removeClass("form-control-static"),e(n).find("label").addClass("hide"),1===e(t).find("[data-formset-form]").length&&(e(this).find("label.hide").removeClass("hide"),i&&e(this).find(".field_wrapper").removeClass("col-md-offset-2")),HLSelect2.init()}),t.on("formDeleted","[data-formset-form]",function(){e(this).stop().slideDown(),e(this).find(":input:enabled:visible").attr("data-formset-disabled",!0).attr("readonly","readonly"),e(this).find("[data-formset-delete-button]").toggleClass("hidden"),e(this).find("[data-formset-undo-delete]").toggleClass("hidden")}),t.on("click","[data-formset-form] [data-formset-undo-delete]",function(){var t=e(this).closest("[data-formset-form]");t.find("[data-formset-disabled=true]").removeAttr("data-formset-disabled").removeAttr("readonly"),t.find('input[name$="DELETE"]').attr("checked",!1).change(),t.find("[data-formset-delete-button]").toggleClass("hidden"),e(this).toggleClass("hidden")})}}}(jQuery,window,document)}(angular),function(e){"use strict";!function(e,t,n,i){t.HLSelect2={config:{tagInputs:"input.tags",ajaxInputs:"input.select2ajax",tagsAjaxClass:"tags-ajax",ajaxPageLimit:30,clearText:"-- Clear --"},init:function(t){var n=this;e.isPlainObject(t)&&e.extend(n.config,t),n.setupSelect2(),n.initListeners()},initListeners:function(){var t=this;e(n).on("shown.bs.modal",".modal",function(){t.setupSelect2()})},setupSelect2:function(){e("select").select2({minimumResultsForSearch:9}),this.createTagInputs(),this.createAjaxInputs()},createTagInputs:function(){e(this.config.tagInputs).each(function(){if(!e(this).data().hasOwnProperty("select2")){var t=[],n=e(this);n.data("choices")&&(t=n.data("choices").split(",")),n.select2({tags:t,tokenSeparators:[","," "],width:"100%"})}})},createAjaxInputs:function(){var t=this,n=t.config;e(n.ajaxInputs).each(function(){var t=e(this),i=t.data();if(!i.hasOwnProperty("select2")){var r={ajax:{cache:!0,data:function(r,a){var o=null;if(t.hasClass(n.tagsAjaxClass)&&!i.tags){""===r&&(r="*");var s="((_type:contacts_contact AND (name:"+r+" OR email_addresses.email_address:"+r+")) OR (_type:accounts_account AND (name:"+r+" OR email_addresses.email_address:"+r+"))) AND email_addresses.email_address:*";o={filterquery:s,size:n.ajaxPageLimit,page:a-1,sort:"-modified"}}else{var c=r.trim();o={filterquery:c?"name:("+c+")":"",size:n.ajaxPageLimit,page:a-1,sort:"-modified"}}var l=t.data("filter-on");return"undefined"!=typeof l&&""!==l&&l.split(",").forEach(function(t){if(0===t.indexOf("id_")){var n=e("#"+t).val(),i=t.substring(3);0===i.indexOf("case_quickbutton_")?i=t.substring(20):"account"==i&&(i="accounts.id"),n&&n>0&&(o.filterquery+=" "+i+":"+n)}else o.type=t}),o},results:function(e,r){var a=r*n.ajaxPageLimit<e.total;if(t.hasClass(n.tagsAjaxClass)&&!i.tags){var o=[];e.hits.forEach(function(e){for(var t=0;t<e.email_addresses.length;t++){var n='"'+e.name+'" <'+e.email_addresses[t].email_address+">",i=e.name+" <"+e.email_addresses[t].email_address+">";o.push({id:n,text:i,object_id:e.id})}}),e.hits=o}else e.hits.forEach(function(e){e.text=e.name});return 1!=r||t.hasClass(n.tagsAjaxClass)||i.tags||e.hits.unshift({id:-1,text:n.clearText}),{results:e.hits,more:a}}},initSelection:function(e,t){var n=e.val(),i=e.data("selected-text"),r={id:n,text:i};t(r)}};t.hasClass(n.tagsAjaxClass)&&(r.tags=!0,r.tokenSeparators=[","," "],r.createSearchChoice=function(t,n){return 0===e(n).filter(function(){return 0===this.text.localeCompare(t)}).length?{id:t,text:t}:void 0},r.openOnEnter=!1),i.tags&&(r.tags=!0,r.multiple=!0),t.select2(r),i.tags&&t.select2("data",i.initial)}})}}}(jQuery,window,document)}(angular),function(e){"use strict";!function(e,t,n,i){t.HLShowAndHide={config:{selector:".show-and-hide-input"},init:function(t){var n=this;e.isPlainObject(t)&&e.extend(n.config,t),n.initListeners()},initListeners:function(){e("body").on("click",".form .toggle-original-form-input",function(){var t=e(this).closest(".show-and-hide-input");if(e(this).parent().addClass("hide"),"show"==e(this).data("action")){e(t).find('[data-action="hide"]').parent().removeClass("hide"),e(t).find(".original-form-widget").removeClass("hide"),e(t).find(":input").removeAttr("disabled");var n=e(t).find(':input:visible:not([type="file"]):first');n&&setTimeout(function(){},0)}else"hide"==e(this).data("action")&&(e(t).find('[data-action="show"]').parent().removeClass("hide"),e(t).find(".original-form-widget").addClass("hide"),e(t).find(":input").attr("disabled","disabled"))})}}}(jQuery,window,document)}(angular),function(e){"use strict";function t(){return function(e){return e.sort(function(e,t){return e-t}),e[0]}}e.module("app.filters").filter("minValue",t)}(angular),function(e){"use strict";function t(e){return function(t,n){var n=n||!0,i=n?"<br />":"<br>",t=(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+i+"$2");return e.trustAsHtml(t)}}e.module("app.filters").filter("nl2br",t),t.$inject=["$sce"]}(angular),function(e){"use strict";function t(e){return function(t,n,i){var r,a,o,s,c,l,u,d,f=new Date;if(t instanceof Date||(t=new Date(t),i&&(t.setHours(23),t.setMinutes(59),t.setSeconds(59))),o=null,c=60,s=60*c,a=24*s,l=7*a,u=30*a,d=365*a,r=function(){return o=Math.round((t-f)/1e3)},r(),o>a&&l>o&&(t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i&&(t.setHours(23),t.setMinutes(59),t.setSeconds(59)),r()),n||(n=window.innerWidth<992?"dd MMM. yyyy":"dd MMMM yyyy"),0>o)switch(!1){case!(-o>l):return e("date")(t,n);case!(-o>2*a):return""+-Math.ceil(o/a)+" days ago";case!(-o>a):return"yesterday";case!(-o>s):return""+-Math.ceil(o/s)+" hours ago";case!(-o>2*c):return""+-Math.ceil(o/c)+" minutes ago";case!(-o>c):return"a minutes ago";case!(-o>30):return""+-o+" seconds ago";default:return"just now"}else switch(!1){case!(30>o):return"just now";case!(c>o):return""+o+" seconds";case!(2*c>o):return"a minute";case!(s>o):return""+Math.floor(o/c)+" minutes";case 1!==Math.floor(o/s):return"an hour";case!(a>o):return""+Math.floor(o/s)+" hours";case!(2*a>o):return"tomorrow";case!(l>o):return""+Math.floor(o/a)+" days";case 1!==Math.floor(o/l):return"a week";default:return e("date")(t,n)}}}e.module("app.filters").filter("relativeDate",t),t.$inject=["$filter"]}(angular),function(e){"use strict";function t(e){return function(t){return e.trustAsResourceUrl(t)}}e.module("app.filters").filter("trustAsResourceUrl",t),t.$inject=["$sce"]}(angular),function(e){"use strict";function t(){return{restrict:"E",replace:!0,transclude:!0,scope:{model:"="},templateUrl:"js/base/directives/checkbox.html"}}e.module("app.directives").directive("checkbox",t)}(angular),function(e){"use strict";function t(e){return{restrict:"A",require:"ngModel",link:function(t,n,i,r){r.$formatters.push(function(t){return t?e(t,i.dateFormatter):void 0})}}}e.module("app.directives").directive("dateFormatter",t),t.$inject=["dateFilter"]}(angular),function(e){"use strict";function t(e){return{restrict:"A",link:function(t,n,i){$(n).click(function(){confirm("You are deleting! Are you sure ?")&&e.go(".delete")})}}}e.module("app.directives").directive("detailDelete",t),t.$inject=["$state"]}(angular),function(e){"use strict";function t(){return{restrict:"A",link:function(e,t,n){var i=$("body").outerHeight();t.on("load",function(){t.removeClass("hidden");var e,n=this;try{e=n.contentWindow.document.documentElement}catch(r){try{e=n.contentDocument.documentElement}catch(a){}}if(e){var o=[t.offset().top,$(".footer").outerHeight(),$(".inbox-attached").outerHeight()];for(var s in o)i-=s;n.height=e.scrollHeight>i?i:e.scrollHeight}})}}}e.module("app.directives").directive("resizeIframe",t)}(angular),function(e){"use strict";function t(){var e=function(e,t,n){e.sorted=e.table.order.column===n?e.table.order.ascending?1:-1:0};return{restrict:"A",scope:{table:"="},transclude:!0,templateUrl:"js/base/directives/sort_column.html",link:function(t,n,i){t.$watchCollection("table.order",function(){e(t,n,i.sortColumn)}),n.on("click",function(){t.table.order.column===i.sortColumn?(t.table.order.ascending=!t.table.order.ascending,t.$apply()):(t.table.order.column=i.sortColumn,t.$apply())})}}}e.module("app.directives").directive("sortColumn",t)}(angular),function(e){"use strict";function t(e){return{link:function(t,n,i){n.addClass("hide"),e.$on("$stateChangeStart",function(){n.removeClass("hide")}),e.$on("$stateChangeSuccess",function(){n.addClass("hide"),$("body").removeClass("page-on-load"),setTimeout(function(){Metronic.scrollTop()},e.settings.layout.pageAutoScrollOnLoad)}),e.$on("$stateNotFound",function(){n.addClass("hide")}),e.$on("$stateChangeError",function(){n.addClass("hide")})}}}e.module("app.directives").directive("ngSpinnerBar",t),t.$inject=["$rootScope"]}(angular),function(e){"use strict";function t(e){e.state("base",{"abstract":!0,controller:"baseController",ncyBreadcrumb:{label:"Lily"}})}function n(t,n,i){function r(){t.$on("$stateChangeSuccess",s),t.$on("$viewContentLoaded",o)}function a(){i.query(function(t){e.forEach(t,function(e){toastr[e.level](e.message)})},function(e){console.log("error!"),console.log(e)})}function o(){Metronic.initComponents(),HLSelect2.init(),HLFormsets.init(),HLShowAndHide.init(),autosize($("textarea")),t.loadNotifications()}function s(e,i,r,a,o){t.previousState=n.href(a,o)}t.conf={headTitle:"Welcome!",pageTitleBig:"HelloLily",pageTitleSmall:"welcome to my humble abode!"},t.loadNotifications=a,r()}e.module("app.base").config(t),t.$inject=["$stateProvider"],e.module("app.base").controller("baseController",n),n.$inject=["$scope","$state","Notifications"]}(angular),function(e){"use strict";function t(e){e.$on("$includeContentLoaded",function(){Layout.initHeader()})}e.module("app.base").controller("headerController",t),t.$inject=["$scope"]}(angular),function(e){"use strict";function t(e){e.$on("$includeContentLoaded",function(){Layout.initSidebar()})}e.module("app.base").controller("sidebarController",t),t.$inject=["$scope"]}(angular),function(e){"use strict";function t(e){function t(e){return new n(e)}function n(e){this.prefix=e}return n.prototype.get=function(t,n){try{var i=e.get(this.prefix+t);return void 0!==i?i:n}catch(r){return e.remove(this.prefix+t),n}},n.prototype.put=function(t,n){e.put(this.prefix+t,n)},t}e.module("app.services").service("Cookie",t),t.$inject=["$cookieStore"]}(angular),function(e){"use strict";function t(){this.getSubtractedDate=function(e){var t=new Date;return t.setDate(t.getDate()-e),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}}e.module("app.services").service("HLDate",t)}(angular),function(e){"use strict";function t(){this.updateFilterQuery=function(e){e.table.filterQuery="",e.displayFilterClear=!1;for(var t=[],n=0;n<e.filterList.length;n++){var i=e.filterList[n];i.id&&"archived"==i.id?i.selected?e.displayFilterClear=!0:t.push("archived:false"):i.selected&&(t.push(i.value),e.displayFilterClear=!0)}e.table.filterQuery=t.join(" AND ")},this.clearFilters=function(e){for(var t=0;t<e.filterList.length;t++)e.filterList[t].selected=!1;e.updateFilterQuery()}}e.module("app.services").service("HLFilters",t)}(angular),function(e){"use strict";function t(){String.prototype.hlCapitalize=function(){var e=this.toLowerCase();return e.charAt(0).toUpperCase()+e.substring(1)}}e.module("app.services").service("HLText",t)}(angular),function(e){"use strict";function t(e){return e("/api/utils/notifications/")}e.module("app.services").factory("Notifications",t),t.$inject=["$resource"]}(angular);
//# sourceMappingURL=app.min.js.map