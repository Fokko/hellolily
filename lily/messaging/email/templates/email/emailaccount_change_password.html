{% load i18n bootstrap3 %}

<form class="form form-horizontal" action="{% url 'messaging_email_account_change_password' pk=object.pk %}" method="post" data-async role="form">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
        <h4>{% trans 'Invalid credentials' %}</h4>
        <span class="label label-info">{{ object }}</span>
    </div>
    <div class="modal-body">
        {% csrf_token %}
        {% trans 'The credentials for this email account are not correct. Please provide a new password or delete the account.' %}
        <div class="form-body">
            {% block form-fields %}
                {% bootstrap_form form layout="horizontal" field_class="col-md-8" label_class="col-md-4" %}
            {% endblock %}
        </div>
        <div data-async-response></div>
    </div>
    <div class="modal-footer">
        <button type="button" data-dismiss="modal" class="btn btn-default">{% trans 'Cancel' %}</button>
        <a href="#confirm-delete-modal" data-toggle="modal" class="btn btn-danger">{% trans 'Delete account' %}</a>
        <button type="submit" class="btn btn-primary" data-loading-text="<i class='icon-spinner icon-spin icon-large'></i> {% trans 'Saving new password..' %}">{% trans 'Save' %}</button>
    </div>
</form>

<div id="confirm-delete-modal" class="modal fade">
    <form class="form form-horizontal" action="{% url 'messaging_email_account_delete' pk=object.pk %}" method="post" data-async role="form">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title">{% trans 'Delete account' %}</h4>
                </div>
                <div class="modal-body">
                   {% csrf_token %}
                   {% trans 'Are you sure you want to delete this email account?' %}
                </div>
                <div class="modal-footer">
                    <button type="button" data-dismiss="modal" class="btn btn-default">{% trans 'Cancel' %}</button>
                    <button type="submit" class="btn btn-danger">{% trans 'Confirm' %}</button>
                </div>
            </div>
        </div>
    </form>
</div>
